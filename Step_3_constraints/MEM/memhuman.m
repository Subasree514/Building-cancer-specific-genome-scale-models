%% minimal essential media (mem) nutreints 
memmets={'arg_L[e]'
'Lcystin[e]'
'his_L[e]'
'ile_L[e]'
'leu_L[e]'
'lys_L[e]'
'met_L[e]'
'phe_L[e]'
'thr_L[e]'
'trp_L[e]'
'tyr_L[e]'
'val_L[e]'
'btn[e]'
'chol[e]'
'pnto_R[e]'
'fol[e]'
'ncam[e]'
'pydxn[e]'
'ribflv[e]'
'thm[e]'
'inost[e]'
'ca2[e]'
'mg2[e]'
'k[e]'
'hco3[e]'
'na1[e]'
'cl[e]'
'so4[e]'
'pi[e]'
'glc_D[e]'
'o2[e]'};
model3=addExchangeRxn(model3,memmets);
%%
contains(model3.rxns,'EX_');
find(ans==1);
model3.lb(ans)=0;
contains(model3.rxns,'EX_');
find(ans==1);
model3.ub(ans)=1000;
memexchanges={'EX_arg_L[e]'
'EX_Lcystin[e]'
'EX_his_L[e]'
'EX_ile_L[e]'
'EX_leu_L[e]'
'EX_lys_L[e]'
'EX_met_L[e]'
'EX_phe_L[e]'
'EX_thr_L[e]'
'EX_trp_L[e]'
'EX_tyr_L[e]'
'EX_val_L[e]'
'EX_btn[e]'
'EX_chol[e]'
'EX_pnto_R[e]'
'EX_fol[e]'
'EX_ncam[e]'
'EX_pydxn[e]'
'EX_ribflv[e]'
'EX_thm[e]'
'EX_inost[e]'
'EX_ca2[e]'
'EX_mg2[e]'
'EX_k[e]'
'EX_hco3[e]'
'EX_na1[e]'
'EX_cl[e]'
'EX_so4[e]'
'EX_pi[e]'
'EX_glc_D[e]'
'EX_o2[e]'};
memconstraints=[0.015708028
0.008067899
0.008145976
0.031324697
0.031324697
0.031453538
0.007944377
0.015782828
0.031830914
0.003094672
0.015722358
0.031700553
6.46837E-05
0.000112734
3.30877E-05
3.57887E-05
0.000129367
7.73668E-05
4.19756E-06
4.68333E-05
0.000175365
0.028437528
0.012849853
0.084175084
0.413359788
2.279771911
1.96301317
0.012849853
0.016011565
0.087682379
2];
run memtransports.m
%%
findRxnIDs(model3,memexchanges);
model3.lb(ans)=-1*memconstraints;
optimizeCbModel(model3)